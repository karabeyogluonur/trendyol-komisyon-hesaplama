@model MarketplaceAccountSelectorViewModel

<form id="accountSwitcherForm" asp-controller="Common" asp-action="SetCurrentMarketplaceAccount" method="post">
    <input type="hidden" name="accountId" id="switcher_accountId" />
    <input type="hidden" name="returnUrl" value="@Context.Request.Path" />
</form>

<script>
    function switchAccount(id) {
        document.getElementById('switcher_accountId').value = id;
        document.getElementById('accountSwitcherForm').submit();
    }
</script>
<div class="app-navbar-item ms-1 ms-md-4">
    <div class="btn btn-icon btn-custom btn-icon-muted btn-active-light btn-active-color-primary w-auto h-35px px-3"
        data-kt-menu-trigger="{default: 'click', lg: 'hover'}" data-kt-menu-attach="parent"
        data-kt-menu-placement="bottom-end">

        <i class="ki-duotone ki-shop fs-2">
            <span class="path1"></span><span class="path2"></span>
            <span class="path3"></span><span class="path4"></span>
            <span class="path5"></span>
        </i>

        @if (Model.CurrentMarketplaceAccount != null)
        {
            <span class="ms-2 fw-bold text-gray-700 fs-7 d-none d-md-inline-block">
                @Model.CurrentMarketplaceAccount.StoreName
            </span>
        }
        else
        {
            <span class="ms-2 fw-semibold text-gray-500 fs-7 d-none d-md-inline-block">
                Mağaza Seçiniz
            </span>
        }
    </div>

    <div class="menu menu-sub menu-sub-dropdown menu-column w-100 w-sm-350px" data-kt-menu="true">
        <div class="card">
            <div class="card-header">
                <div class="card-title">Mağazalarım</div>
                <div class="card-toolbar">
                    <button type="button" class="btn btn-sm btn-icon btn-active-light-primary me-n3"
                        data-kt-menu-trigger="{default: 'click', lg: 'hover'}" data-kt-menu-placement="bottom-end">
                        <i class="ki-duotone ki-setting-3 fs-2">
                            <span class="path1"></span><span class="path2"></span><span class="path3"></span>
                            <span class="path4"></span><span class="path5"></span>
                        </i>
                    </button>
                    <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg-light-primary fw-semibold w-200px py-3"
                        data-kt-menu="true">
                        <div class="menu-item px-3">
                            <div class="menu-content text-muted pb-2 px-3 fs-7 text-uppercase">Yönetim</div>
                        </div>
                        <div class="menu-item px-3">
                            <a href="@Url.Action("Add", "MarketplaceAccount")" class="menu-link px-3">Yeni Mağaza
                                Ekle</a>
                        </div>
                        <div class="menu-item px-3">
                            <a href="@Url.Action("Index", "MarketplaceAccount")" class="menu-link px-3">Tüm Hesaplar</a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card-body py-5">
                <div class="mh-450px scroll-y me-n5 pe-5">
                    <div class="row g-2">

                        @if (Model.MarketplaceAccounts != null && Model.MarketplaceAccounts.Any())
                        {
                            foreach (var account in Model.MarketplaceAccounts)
                            {
                                var isActive = account.Id == Model.CurrentMarketplaceAccountId;
                                var activeClass = isActive ? "bg-light-primary border border-primary border-dashed" :
                                "bg-hover-light";

                                <div class="col-4">
                                    <a href="javascript:;" onclick="switchAccount(@account.Id)"
                                        class="d-flex flex-column flex-center text-center text-gray-800 text-hover-primary rounded py-4 px-3 mb-3 @activeClass">

                                        <div class="symbol symbol-35px mb-2">
                                            <marketplace-logo type="@account.MarketplaceType" class="symbol-label p-1" />
                                        </div>
                                        <span class="fw-semibold text-truncate w-100 fs-7" title="@account.StoreName">
                                            @account.StoreName
                                        </span>
                                    </a>
                                </div>
                            }

                            <div class="col-4">
                                <a href="@Url.Action("Add", "MarketplaceAccount")"
                                    class="d-flex flex-column flex-center text-center text-gray-400 text-hover-primary bg-hover-light rounded py-4 px-3 mb-3">
                                    <i class="ki-duotone ki-plus fs-2x mb-2"></i>
                                    <span class="fw-semibold fs-7">Yeni Ekle</span>
                                </a>
                            </div>
                        }
                        else
                        {
                            <div class="col-12 text-center text-muted py-5">
                                <span class="d-block mb-2">Henüz mağaza yok.</span>
                                <a href="@Url.Action("Add", "MarketplaceAccount")" class="btn btn-sm btn-light-primary">
                                    İlk Mağazanı Ekle
                                </a>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
